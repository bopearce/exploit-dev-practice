#include <stdio.h>
#include <string.h>

// FIXME: Get size from the ELF 
//        Actually it should be fine to just search the .rodata section
#define SIZE  0x1fffff 

int main ()
{
  unsigned char *ptr, *ptr2;

  printf ("Libc base address: ");
  scanf ("%p", &ptr);
  ptr2 = ptr;
  printf ("Looking for '/bin/sh'...");
  for (;ptr < ptr2 + SIZE; ptr++)
    if (!strncmp (ptr, "/bin/sh\0", 7))
      {
	printf("Found at %p %x (%s)\n", ptr, ptr - ptr2, ptr);
	break; 
      }
}

